import { Callout, Tabs } from 'nextra/components';
import { LinkedTabs } from '@/components/linked-tabs';

# Custom Cache Updates

Sometimes, you will find yourself writing custom cache updates. The library exports two convenience hooks that expose the underlying cache operations.

<Callout emoji="❗">
  These hooks do not do any API requests. They only update the local cache.
</Callout>

## `useDeleteItem`

Delete a postgrest entity from the cache. Note that you have to pass a value for all primary keys in the input.

<LinkedTabs items={['SWR', 'React Query']} id="data-fetcher">
  <Tabs.Tab>
    ```tsx
    import { useDeleteItem } from "@supabase-cache-helpers/postgrest-swr";

    function Page() {
        const deleteItem = useDeleteItem({
          primaryKeys: ['id'],
          table: 'contact',
          schema: 'public',
          opts,
        });

      return <div>...</div>;
    }
    ```

  </Tabs.Tab>
  <Tabs.Tab>
    ```tsx
    import { useDeleteItem } from "@supabase-cache-helpers/postgrest-react-query";

    function Page() {
        const deleteItem = useDeleteItem({
          primaryKeys: ['id'],
          table: 'contact',
          schema: 'public',
          opts,
        });

      return <div>...</div>;
    }
    ```

  </Tabs.Tab>
</LinkedTabs>

## `useUpsertItem`

Upsert a postgrest entity into the cache. Note that you have to pass a value for all primary keys in the input.

<LinkedTabs items={['SWR', 'React Query']} id="data-fetcher">
  <Tabs.Tab>
    ```tsx
    import { useUpsertItem } from "@supabase-cache-helpers/postgrest-swr";

    function Page() {
        const upsertItem = useUpsertItem({
          primaryKeys: ['id'],
          table: 'contact',
          schema: 'public',
          opts,
        });

      return <div>...</div>;
    }
    ```

  </Tabs.Tab>
  <Tabs.Tab>
    ```tsx
    import { useUpsertItem } from "@supabase-cache-helpers/postgrest-react-query";

    function Page() {
        const upsertItem = useUpsertItem({
          primaryKeys: ['id'],
          table: 'contact',
          schema: 'public',
          opts,
        });

      return <div>...</div>;
    }
    ```

  </Tabs.Tab>
</LinkedTabs>

## `useRevalidateTables`

Revalidate all queries for the given tables.

<LinkedTabs items={['SWR', 'React Query']} id="data-fetcher">
  <Tabs.Tab>
    ```tsx
    import { useRevalidateTables } from "@supabase-cache-helpers/postgrest-swr";

    function Page() {
        const revalidateTables = useRevalidateTables([{ schema: 'public', table: 'contact' }]);

      return <div>...</div>;
    }
    ```

  </Tabs.Tab>
  <Tabs.Tab>
    ```tsx
    import { useRevalidateTables } from "@supabase-cache-helpers/postgrest-react-query";

    function Page() {
        const revalidateTables = useRevalidateTables([{ schema: 'public', table: 'contact' }]);

      return <div>...</div>;
    }
    ```

  </Tabs.Tab>
</LinkedTabs>
